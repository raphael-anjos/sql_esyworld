/*Data:2018-03-26
Objetivo: Inserir em uma lista os itens de outra lista
*/
SELECT tb_preco, count(cod_produto)
FROM cd_preco_item
WHERE tb_preco LIKE 'cyla%'
GROUP BY 1;

START TRANSACTION;
SET @TabelaDe = 'CYLANCE_ESME';
SET @TabelaPara = 'CYLANCE_GOLD' ;

INSERT IGNORE INTO cd_preco_item (qtd_min,tb_preco,cod_produto,preco_unit,situacao,dt_alteracao, ind_ajuste_preco,qtd_ponto,ind_variacao_diferenciada,perc_variacao_max, perc_variacao_min,preco_minimo,preco_maximo,precificacao)
SELECT 	qtd_min,@TabelaPara,cod_produto,preco_unit,situacao,NOW() AS DATA,ind_ajuste_preco,qtd_ponto,ind_variacao_diferenciada,perc_variacao_max, perc_variacao_min,preco_minimo,preco_maximo,precificacao
FROM cd_preco_item 
WHERE tb_preco = @TabelaDe 
AND cod_produto IN ('KL4746KAKD8','KL4746KAKD9','KL4746KAKDR','KL4746KAKDS',
'KL4746KAKF8','KL4746KAKF9','KL4746KAKFG','KL4746KAKFR','KL4746KAKFS','KL4746KAKMG','KL4746KAKT8','KL4746KAKT9',
'KL4746KAKTR','KL4746KAKTS','KL4746KAMD8','KL4746KAMD9','KL4746KAMDR','KL4746KAMDS','KL4746KAMF8','KL4746KAMF9',
'KL4746KAMFG','KL4746KAMFR','KL4746KAMFS','KL4746KAMMG','KL4746KAMT8','KL4746KAMT9','KL4746KAMTR','KL4746KAMTS',
'KL4746KAND8','KL4746KAND9','KL4746KANDR','KL4746KANDS','KL4746KANF8','KL4746KANF9','KL4746KANFG','KL4746KANFR',
'KL4746KANFS','KL4746KANMG','KL4746KANT8','KL4746KANT9','KL4746KANTR','KL4746KANTS','KL4746KAPD8','KL4746KAPD9',
'KL4746KAPDR','KL4746KAPDS','KL4746KAPF8','KL4746KAPF9','KL4746KAPFG','KL4746KAPFR','KL4746KAPFS','KL4746KAPMG',
'KL4746KAPT8','KL4746KAPT9','KL4746KAPTR','KL4746KAPTS','KL4746KAQD8','KL4746KAQD9','KL4746KAQDR','KL4746KAQDS',
'KL4746KAQF8','KL4746KAQF9','KL4746KAQFG','KL4746KAQFR','KL4746KAQFS','KL4746KAQMG','KL4746KAQT8','KL4746KAQT9',
'KL4746KAQTR','KL4746KAQTS','KL4746KARD8','KL4746KARD9','KL4746KARDR','KL4746KARDS','KL4746KARF8','KL4746KARF9',
'KL4746KARFG','KL4746KARFR','KL4746KARFS','KL4746KARMG','KL4746KART8','KL4746KART9','KL4746KARTR','KL4746KARTS',
'KL4746KASD8','KL4746KASD9','KL4746KASDR','KL4746KASDS','KL4746KASF8','KL4746KASF9','KL4746KASFG','KL4746KASFR',
'KL4746KASFS','KL4746KASMG','KL4746KAST8','KL4746KAST9','KL4746KASTR','KL4746KASTS','KL4746KATD8','KL4746KATD9',
'KL4746KATDR','KL4746KATDS','KL4746KATF8','KL4746KATF9','KL4746KATFG','KL4746KATFR','KL4746KATFS','KL4746KATMG',
'KL4746KATT8','KL4746KATT9','KL4746KATTR','KL4746KATTS','KL4746KAUD8','KL4746KAUD9','KL4746KAUDR','KL4746KAUDS',
'KL4746KAUF8','KL4746KAUF9','KL4746KAUFG','KL4746KAUFR','KL4746KAUFS','KL4746KAUMG','KL4746KAUT8','KL4746KAUT9',
'KL4746KAUTR','KL4746KAUTS','KL7890KAADR','KL7890KAADS','KL7890KAAFR','KL7890KAAFS','KL7890KAATR','KL7890KAATS',
'KL7891KCKD8','KL7891KCKD9','KL7891KCKDR','KL7891KCKDS','KL7891KCKF8','KL7891KCKF9','KL7891KCKFR','KL7891KCKFS',
'KL7891KCKT8','KL7891KCKT9','KL7891KCKTR','KL7891KCKTS','KL7891KCND8','KL7891KCND9','KL7891KCNDR','KL7891KCNDS',
'KL7891KCNF8','KL7891KCNF9','KL7891KCNFR','KL7891KCNFS','KL7891KCNT8','KL7891KCNT9','KL7891KCNTR','KL7891KCNTS',
'KL7891KCQD8','KL7891KCQD9','KL7891KCQDR','KL7891KCQDS','KL7891KCQF8','KL7891KCQF9','KL7891KCQFR','KL7891KCQFS',
'KL7891KCQT8','KL7891KCQT9','KL7891KCQTR','KL7891KCQTS','KL7891KCRD8','KL7891KCRD9','KL7891KCRDR','KL7891KCRDS',
'KL7891KCRF8','KL7891KCRF9','KL7891KCRFR','KL7891KCRFS','KL7891KCRT8','KL7891KCRT9','KL7891KCRTR','KL7891KCRTS',
'KL7891KCUD8','KL7891KCUD9','KL7891KCUDR','KL7891KCUDS','KL7891KCUF8','KL7891KCUF9','KL7891KCUFR','KL7891KCUFS',
'KL7891KCUT8','KL7891KCUT9','KL7891KCUTR','KL7891KCUTS','KL7891KCVD8','KL7891KCVD9','KL7891KCVDR','KL7891KCVDS',
'KL7891KCVF8','KL7891KCVF9','KL7891KCVFR','KL7891KCVFS','KL7891KCVT8','KL7891KCVT9','KL7891KCVTR','KL7891KCVTS',
'KL7892KCKD8','KL7892KCKD9','KL7892KCKDR','KL7892KCKDS','KL7892KCKF8','KL7892KCKF9','KL7892KCKFR','KL7892KCKFS',
'KL7892KCKT8','KL7892KCKT9','KL7892KCKTR','KL7892KCKTS','KL7892KCND8','KL7892KCND9','KL7892KCNDR','KL7892KCNDS',
'KL7892KCNF8','KL7892KCNF9','KL7892KCNFR','KL7892KCNFS','KL7892KCNT8','KL7892KCNT9','KL7892KCNTR','KL7892KCNTS',
'KL7892KCQD8','KL7892KCQD9','KL7892KCQDR','KL7892KCQDS','KL7892KCQF8','KL7892KCQF9','KL7892KCQFR','KL7892KCQFS',
'KL7892KCQT8','KL7892KCQT9','KL7892KCQTR','KL7892KCQTS','KL7892KCRD8','KL7892KCRD9','KL7892KCRDR','KL7892KCRDS',
'KL7892KCRF8','KL7892KCRF9','KL7892KCRFR','KL7892KCRFS','KL7892KCRT8','KL7892KCRT9','KL7892KCRTR','KL7892KCRTS',
'KL7892KCUD8','KL7892KCUD9','KL7892KCUDR','KL7892KCUDS','KL7892KCUF8','KL7892KCUF9','KL7892KCUFR','KL7892KCUFS',
'KL7892KCUT8','KL7892KCUT9','KL7892KCUTR','KL7892KCUTS','KL7892KCVD8','KL7892KCVD9','KL7892KCVDR','KL7892KCVDS',
'KL7892KCVF8','KL7892KCVF9','KL7892KCVFR','KL7892KCVFS','KL7892KCVT8','KL7892KCVT9','KL7892KCVTR','KL7892KCVTS',
'KL7893KAADR','KL7893KAADS','KL7893KAAFR','KL7893KAAFS','KL7893KAATR','KL7893KAATS','KL7925KARDR','KL7925KARDS',
'KL7925KARFR','KL7925KARFS','KL7925KARTR','KL7925KARTS','KL7925KASDR','KL7925KASDS','KL7925KASFR','KL7925KASFS',
'KL7925KASTR','KL7925KASTS','KL7925KATDR','KL7925KATDS','KL7925KATFR','KL7925KATFS','KL7925KATTR','KL7925KATTS',
'KL7925KAUDR','KL7925KAUDS','KL7925KAUFR','KL7925KAUFS','KL7925KAUTR','KL7925KAUTS','KL7925KAVDR','KL7925KAVDS',
'KL7925KAVFR','KL7925KAVFS','KL7925KAVTR','KL7925KAVTS','KL7925KAWDR','KL7925KAWDS','KL7925KAWFR','KL7925KAWFS',
'KL7925KAWTR','KL7925KAWTS','KL7926KAUDR','KL7926KAUDS','KL7926KAUFR','KL7926KAUFS','KL7926KAUTR','KL7926KAUTS',
'KL7926KAVDR','KL7926KAVDS','KL7926KAVFR','KL7926KAVFS','KL7926KAVTR','KL7926KAVTS','KL7926KAWDR','KL7926KAWDS',
'KL7926KAWFR','KL7926KAWFS','KL7926KAWTR','KL7926KAWTS','KL7934KARDR','KL7934KARDS','KL7934KARFR','KL7934KARFS',
'KL7934KARTR','KL7934KARTS','KL7934KASDR','KL7934KASDS','KL7934KASFR','KL7934KASFS','KL7934KASTR','KL7934KASTS',
'KL7934KATDR','KL7934KATDS','KL7934KATFR','KL7934KATFS','KL7934KATTR','KL7934KATTS','KL7934KAUDR','KL7934KAUDS',
'KL7934KAUFR','KL7934KAUFS','KL7934KAUTR','KL7934KAUTS','KL7934KAVDR','KL7934KAVDS','KL7934KAVFR','KL7934KAVFS',
'KL7934KAVTR','KL7934KAVTS','KL7934KAWDR','KL7934KAWDS','KL7934KAWFR','KL7934KAWFS','KL7934KAWTR','KL7934KAWTS',
'KL8614KCADR','KL8614KCADS','KL8614KCAFR','KL8614KCAFS','KL8614KCATR','KL8614KCATS','KL8614KCBDR','KL8614KCBDS',
'KL8614KCBFR','KL8614KCBFS','KL8614KCBTR','KL8614KCBTS','KL8614KCCDR','KL8614KCCDS','KL8614KCCFR','KL8614KCCFS',
'KL8614KCCTR','KL8614KCCTS','KL8614KCDDR','KL8614KCDDS','KL8614KCDFR','KL8614KCDFS','KL8614KCDTR','KL8614KCDTS',
'KL8614KCEDR','KL8614KCEDS','KL8614KCEFR','KL8614KCEFS','KL8614KCETR','KL8614KCETS');


UPDATE cd_preco_item
SET dt_alteracao = NOW()
WHERE tb_preco = @TabelaPara;

SELECT *
FROM cd_preco_item
WHERE tb_preco = @Tabelade;

ROLLBACK:
COMMIT;


